家庭开放平台家庭账户建设规划
	背景
家庭账户的建设，旨在针对家庭用户的消费特征和支付场景，满足通过魔百和为家庭用户提供一站式的业务办理和支付服务的需求，依托家庭开放平台所建立的家庭用户关系体系和电商基地平台已有的账户体系和支付渠道，为家庭用户提供的统一支付账户。家庭账户的建设，打通了家庭终端，家庭业务的互联网化销售和办理渠道，拓展了家庭用户的付费方式，丰富了家庭用户的业务场景。
	家庭账户建设规划
	家庭体系总览
 
	账户类型
账户类型包括个人账户和家庭账户。
	个人账户：用户在家庭开放平台注册成功后，电商基地平台自动为用户生成个人账户（如果用户已经在电商基地平台上注册过，则自动关联到用户在电商基地平台现有的个人账户）。家庭用户可以使用个人账户在家庭开放平台上进行消费，个人账户仅限用户本人使用。
	家庭账户：家庭用户在家庭开放平台上创建家庭后，可在家庭基础上创建家庭账户，家庭账户可被所有具有使用权限的家庭成员使用。
	家庭账户结构
 
家庭账户，顾名思义，与家庭相绑定，面向家庭成员提供支付能力，家庭开放平台为家庭用户提供创建家庭功能，当用户创建了一个家庭后（以和家庭ID作为一个家庭的唯一标识），就可以添加或邀请其他家庭成员加入家庭，成为家庭内部的一个家庭成员。
家庭管理员——即创建家庭的用户，可以建立家庭账户，并为其他家庭成员授予对家庭账户的使用权限。
	电商基地平台与家庭开放平台的分工界面
 
家庭账户体系的创建在家庭开放平台完成，家庭开放平台通过和家庭ID，建立家庭用户与家庭账户的对应关系，并由家庭管理员设置家庭内部成员对家庭账户的使用权限（充值/支付，消费额度限制等）。
家庭账户的管理，充值和消费由电商基地平台负责，电商基地平台在现有的个人账户类型基础上，增加家庭账户类型，并与个人账户进行关联，关联原则由家庭开放平台提供。当个人账户与家庭账户的关联关系发生变化时，家庭开放平台实时将最新的关联关系数据同步至电商基地平台。
用户在家庭开放平台上注册后，由家庭开放平台将用户的信息同步至电商基地平台，电商基地平台记录其用户账号与家庭开放平台用户账号的对应关系，用户在家庭开放平台发起家庭账户或个人账户操作时，电商基地平台查找与家庭开放平台用户账号对应的电商基地平台用户账号。
	家庭账户充值
 
家庭账户以虚拟货币——家庭币作为统一的消费货币，支持用户通过电商基地平台现有的个人账户充值渠道，向家庭账户进行充值，家庭账户支持手机话费充值，充值卡充值，第三方支付平台充值等充值渠道。同时支持其他虚拟货币兑换充值的充值方式，实现了与电商基地平台现有虚拟货币的流通。另外，通过提供活动奖励充值接口，支持家庭开放平台及电商基地平台以“硬通货”——家庭币作为营销，促销活动的奖励，为家庭业务的运营提供支撑。
	家庭账户消费
 
家庭账户的消费主要通过两个渠道：一是在电商门户实现对家庭终端，家庭业务的互联网化的售卖，对于关联了家庭账户的用户，其在支付时可以选择通过家庭账户进行支付。二是在家庭开放平台门户（魔百和门户，手机客户端门户）上实现通过家庭账户购买各类家庭业务产品，以及各类家庭应用的应用内计费。
按照消费类型家庭账户的消费场景可分为：通过应用商店购买应用，应用内计费支付，公共使业务缴费，电商消费支付，购买家庭终端支付，购买家庭业务/服务支付以及生活类产品服务的支付。
	主要流程
	家庭账户创建流程
 
流程说明：
	家庭管理员在家庭开放平台创建家庭；
	家庭管理员在创建家庭后，在家庭基础上创建家庭账户；
	家庭开放平台携带创建家庭账户的家庭管理员信息，家庭ID，向电商基地平台发起家庭账户开户请求；
	电商基地平台生成家庭账户信息，并与家庭和家庭管理员建立关联关系；
	家庭管理员在家庭开放平台上添加或邀请其他家庭成员加入家庭；
	在家庭成员加入家庭后，家庭管理员配置家庭成员对家庭账户的使用权限，包括能否使用家庭账户进行支付，支付限额等；
	家庭开放平台将家庭成员和家庭成员对家庭账户的使用权限信息同步至电商基地平台；
	电商基地平台对信息进行记录，并根据用户对家庭账户的使用权限为用户提供相应的家庭账户服务。
	家庭开放平台发起的家庭账户消费流程
 
流程说明：
	家庭用户在家庭开放平台上发起家庭账户支付请求；
	家庭开放平台向电商基地平台发起家庭账户查询请求；
	电商基地平台查询家庭用户所对应家庭账户的余额；
	电商基地平台向家庭开放平台返回家庭账户余额；
	家庭用户根据家庭账户余额在家庭开放平台上选择支付方式；
	家庭账户余额支付：
	家庭开放平台向电商基地平台发起家庭账户余额支付请求；
	电商基地平台完成对家庭账户的扣费；
	电商基地平台向家庭开放平台返回家庭账户支付结果；
	其他渠道支付：
	家庭开放平台向电商基地平台发起其他渠道支付请求；
	电商基地平台返回支付渠道；
	家庭用户在家庭开放平台上选择支付渠道；
	家庭用户选择支付渠道，家庭开放平台向电商基地平台发起支付请求；
	电商基地平台生成支付地址，返回给家庭开放平台；
	用户在支付渠道所提供的支付页面上完成支付；
	支付平台通知电商基地平台支付结果；
	电商基地平台完成对家庭账户的扣费；
	电商基地平台通知家庭开放平台支付结果；
	家庭开放平台向用户显示支付结果。
	家庭开放平台产品信息同步流程
 
流程说明：
	管理员在家庭开放平台配置产品信息；
	家庭开放平台根据产品的发售渠道，通过文件接口方式向电商基地平台同步产品信息，产品信息需要包括电商基地平台在进行产品展示时所需要的基本信息；
	电商基地平台记录产品信息；
	产品在家庭开放平台正式上线；
	家庭开放平台向电商基地平台发起产品上线通知请求；
	电商基地平台完成产品上线处理；
	电商基地平台向家庭开放平台返回产品上线响应。

	接口定义
 
	家庭账户创建接口
电商基地平台向家庭开放平台提供家庭账户创建接口，当家庭用户在家庭开放平台上创建家庭账户时，通过此接口向电商基地平台发起创建家庭账户请求，并同步家庭账户数据。
家庭开放平台创建家庭账户时，向电商基地平台提供的数据包括：创建家庭账户的家庭用户信息，家庭账户与其他家庭用户账号的关联关系，以及家庭用户账号对家庭账户的访问权限。
	用户数据同步接口
当家庭用户在家庭开放平台上变更家庭用户对家庭账户的使用权限时，包括：新增允许使用家庭账户的家庭成员，删除允许使用家庭账户的家庭成员，修改家庭成员对家庭账户的使用权限。家庭开放平台需要向电商基地平台发起家庭账户数据变更同步请求，在请求中应至少包括：数据变更类型（新增，修改，删除），变更的家庭账户信息，变更的家庭用户信息等。
	家庭账户查询接口
当家庭用户在家庭开放平台上进行支付时，家庭开放平台需要向电商基地平台查询用户所关联的家庭账户余额。在查询请求中应至少包括：家庭用户信息，家庭账号信息。
	家庭账户充值接口
电商基地平台向家庭开放平台提供家庭账户充值接口，允许家庭用户在家庭开放平台门户向家庭账户发起充值请求，电商基地平台需要根据家庭用户选择的充值方式，为家庭开放平台提供相应的充值接口：
	使用手机话费，充值卡，其他虚拟货币进行充值时，电商基地平台提供相应的充值服务接口。
	使用第三方支付平台进行充值时，电商基地平台提供充值地址（包括充值商户信息），由家庭开放平台通过第三方支付平台的页面支付渠道完成对家庭账户的充值。
此外，电商基地平台向家庭开放平台提供家庭账户后台充值接口，允许家庭开放平台通过此接口为家庭账户以家庭币的形式派发营销活动的奖励。
	家庭账户支付接口
电商地基平台向家庭开放平台开放家庭账户支付接口，允许家庭用户通过家庭开放平台门户发起家庭账户支付请求，家庭账户的支付使用家庭币作为支付货币，在家庭用户发起家庭账户支付请求钱，家庭开放平台先查询家庭账户余额，确保有足够的家庭币完成本次支付。
	家庭账户结算接口
对于通过家庭账户支付的用户，由电商基地平台向家庭开放平台出具支付结算单，完成与家庭开放平台的一级结算，家庭开放平台与各省公司及业务提供商进行二级结算。
	产品信息同步接口
家庭开放平台向电商基地平台提供产品信息同步接口，用于进行家庭开放平台产品在电商基地平台上的上线，变更和下线。
	家庭账户业务量
按照全网家庭开放平台本期支持2000万家庭考虑，预计10%的家庭用户开通家庭账户，则家庭账户的设计容量为2000万*10%=200万，按照20%的活跃账户（对活跃账户的定义是一周内至少使用家庭账户进行过一次支付）考虑，活跃账户数为200万*20%=40万。按照每个活跃账户平台每周充值1次，支付2次计算，则家庭账户需具备的充值能力为：
家庭账户充值处理能力=家庭账户充值次数/时间×峰值系数
=400000/(24×3600×7×0.1)×2=13次/秒
其中，忙时集中比为0.1，即每天的充值请求集中发生在24*0.1=2.4小时内，峰值系数为2。
家庭账户充值处理能力=家庭账户支付次数/时间×峰值系数
=(400000×2)/(24×3600×7×0.1)×2=26次/秒
其中，忙时集中比为0.1，即每天的支付请求集中发生在24*0.1=2.4小时内，峰值系数为2。

